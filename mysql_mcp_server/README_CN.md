# MySQL MCP æœåŠ¡å™¨

ä¸€ä¸ªé«˜æ€§èƒ½çš„ **æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (MCP) æœåŠ¡å™¨**ï¼Œæ”¯æŒä¸ MySQL å…¼å®¹æ•°æ®åº“çš„å®‰å…¨é«˜æ•ˆäº¤äº’ï¼ŒåŒ…æ‹¬ MySQLã€MariaDBã€TiDBã€OceanBaseã€AWS RDS å’Œ Aurora MySQLã€‚

## âœ¨ æ ¸å¿ƒäº®ç‚¹

- **ğŸ—ï¸ ä¸“ä¸šæ¶æ„**: æ¨¡å—åŒ–è®¾è®¡ï¼Œé‡‡ç”¨å•ä¾‹æ¨¡å¼å’Œæ¸…æ™°çš„å…³æ³¨ç‚¹åˆ†ç¦»
- **âš¡ é«˜æ€§èƒ½**: å®Œæ•´çš„ async/await å®ç°ï¼Œæ™ºèƒ½è¿æ¥æ± ç®¡ç†
- **ğŸ›¡ï¸ ä¼ä¸šçº§å®‰å…¨**: å¤šå±‚å®‰å…¨æœºåˆ¶ï¼Œå‚æ•°éªŒè¯å’Œæ•æ„Ÿæ•°æ®ä¿æŠ¤
- **ğŸ”§ é€šç”¨å…¼å®¹æ€§**: æ”¯æŒ 6+ ç§ MySQL å…¼å®¹æ•°æ®åº“ç³»ç»Ÿ
- **ğŸ“Š ç”Ÿäº§å°±ç»ª**: å…¨é¢çš„æ—¥å¿—è®°å½•ã€é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†
- **ğŸ¯ MCP æ ‡å‡†**: åŸºäº FastMCP æ¡†æ¶æ„å»ºï¼Œå®Œå…¨ç¬¦åˆ MCP åè®®

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### **MCP åè®®å®ç°**
- **æ ‡å‡†å·¥å…·ä¸èµ„æº**: å®Œæ•´çš„ MCP å·¥å…·å’Œèµ„æºå®šä¹‰
- **FastMCP æ¡†æ¶**: åŸºäºç¨³å›ºçš„ FastMCP åŸºç¡€æ„å»ºï¼Œç¡®ä¿å¯é æ€§
- **å¼‚æ­¥é€šä¿¡**: éé˜»å¡çš„ MCP æ¶ˆæ¯å¤„ç†

### **æ•°æ®åº“æ“ä½œå·¥å…·**
- **é€šç”¨ SQL æ‰§è¡Œ**: æ‰§è¡Œä»»ä½• SQL è¯­å¥ï¼Œæ™ºèƒ½ç±»å‹æ£€æµ‹
- **è¡¨ç»“æ„åˆ†æ**: å…¨é¢çš„è¡¨å…ƒæ•°æ®å’Œæ¨¡å¼ä¿¡æ¯
- **æµ‹è¯•æ•°æ®ç”Ÿæˆ**: è‡ªåŠ¨åŒ–æµ‹è¯•æ•°æ®åˆ›å»ºï¼Œå¯è‡ªå®šä¹‰å‚æ•°
- **æŸ¥è¯¢ä¼˜åŒ–**: é’ˆå¯¹ä¸åŒ SQL æ“ä½œç±»å‹çš„æ™ºèƒ½ç»“æœå¤„ç†

### **é«˜çº§æ¶æ„**
- **å•ä¾‹è¿æ¥æ± **: é«˜æ•ˆçš„èµ„æºç®¡ç†ï¼Œè‡ªåŠ¨æ¸…ç†
- **æ™ºèƒ½é…ç½®**: å¤šå®ä¾‹æ”¯æŒï¼Œç¯å¢ƒå˜é‡è¦†ç›–
- **å¼‚æ­¥ä¼˜å…ˆè®¾è®¡**: ä»åº•å±‚æ„å»ºçš„å¼‚æ­¥æ“ä½œæ¶æ„
- **æ¨¡å—åŒ–ç»“æ„**: å·¥å…·ã€èµ„æºã€å·¥å…·ç±»å’Œé…ç½®çš„æ¸…æ™°åˆ†ç¦»

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Python >= 3.12
- MySQL/MariaDB/TiDB/OceanBase æ•°æ®åº“å®ä¾‹
- è®¿é—®æ•°æ®åº“æœåŠ¡å™¨çš„ç½‘ç»œè¿æ¥

## ğŸ› ï¸ å®‰è£…é…ç½®

### 1. ä» PyPI å®‰è£…ï¼ˆæ¨èï¼‰
```bash
pip install mysql-mcp-server3
```

### 2. é…ç½®æ•°æ®åº“è¿æ¥

ç¼–è¾‘ `dbconfig.json` æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„æ•°æ®åº“å‡­æ®ï¼š

```json
{
    "dbPoolSize": 5,
    "dbMaxOverflow": 10,
    "dbPoolTimeout": 30,
    "dbType-Comment": "å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¦‚ MySQL/MariaDB/TiDB OceanBase/RDS/Aurora MySQL æ•°æ®åº“",
    "dbList": [
        {   "dbInstanceId": "oceanbase_1",
            "dbHost": "localhost",
            "dbPort": 2281,
            "dbDatabase": "oceanbase_db",
            "dbUsername": "root",
            "dbPassword": "123456",
            "dbType": "OceanBase",
            "dbVersion": "V4.0.0",
            "dbActive": true
        },
        {   "dbInstanceId": "mysql_2",
            "dbHost": "localhost",
            "dbPort": 3306,
            "dbDatabase": "mysql_db",
            "dbUsername": "root",
            "dbPassword": "123456",
            "dbType": "MySQL",
            "dbVersion": "8.0",
            "dbActive": false
        },
        {   "dbInstanceId": "tidb_3",
            "dbHost": "localhost",
            "dbPort": 4000,
            "dbDatabase": "tidb_db",
            "dbUsername": "root",
            "dbPassword": "123456",
            "dbType": "TiDB",
            "dbVersion": "8.5.3",
            "dbActive": false
        }
    ],
    "logPath": "/path/to/logs",
    "logLevel": "info"
}
# dbType
OceanBase å®ä¾‹å±äº MySQL/MariaDB/TiDB OceanBase/RDS/Aurora MySQL æ•°æ®åº“ç±»å‹ã€‚
# dbActive
åªæœ‰åœ¨ dbList é…ç½®åˆ—è¡¨ä¸­å°† dbActive è®¾ç½®ä¸º true çš„æ•°æ®åº“å®ä¾‹æ‰å¯ç”¨ã€‚
# logPath
MCP æœåŠ¡å™¨æ—¥å¿—å­˜å‚¨åœ¨ /path/to/logs/mcp_server.logã€‚
# logLevel
æ”¯æŒçš„æ—¥å¿—çº§åˆ«ï¼šTRACE, DEBUG, INFO, SUCCESS, WARNING, ERROR, CRITICAL
```

### 3. é…ç½® MCP å®¢æˆ·ç«¯

åœ¨ä½ çš„ MCP å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "mcpServers": {
    "mysql-mcp-client": {
      "command": "mysql-mcp-server3",
      "env": {
        "config_file": "/path/to/your/dbconfig.json"
      },
      "disabled": false
    }
  }
}
```

**æ³¨æ„**: è¯·å°† `/path/to/your/dbconfig.json` æ›¿æ¢ä¸ºä½ çš„é…ç½®æ–‡ä»¶çš„å®é™…è·¯å¾„ã€‚

### 4. å…‹éš†ä»“åº“ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
```bash
git clone https://github.com/j00131120/mcp_database_server.git
cd mcp_database_server/oceanbase_mcp_server
# å°†é¡¹ç›®å¯¼å…¥ä½ çš„ IDE
```

### 5. å¼€å‘æ¨¡å¼çš„ MCP å®¢æˆ·ç«¯é…ç½®
```json
{
  "mcpServers": {
    "mysql-mcp-client": {
      "command": "uv",
      "args": [
        "run",
        "src/server.py"
      ],
      "cwd": "/Volumes/store/mysql_mcp_server", //é¡¹ç›®ç»å¯¹è·¯å¾„
      "env": {
        "config_file": "/Volumes/store/dbconfig.json"
      },
      "disabled": false,
      "autoApprove": [
        "describe_table",
        "sql_exec",
        "generate_demo_data"
      ]
    }
  }
}
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¯åŠ¨ MCP æœåŠ¡å™¨
```bash
# ä½¿ç”¨å·²å®‰è£…çš„åŒ…
mysql-mcp-server

# ä½¿ç”¨ fastmcp CLI
fastmcp run src/server.py

# æˆ–è€…ç›´æ¥ä½¿ç”¨ Python
python src/server.py
```

### ä¸ MCP å®¢æˆ·ç«¯é…åˆä½¿ç”¨
æœåŠ¡å™¨æä¾›ä»¥ä¸‹ MCP å·¥å…·å’Œèµ„æºï¼š

#### å·¥å…·
- `sql_exec`: æ‰§è¡Œä»»ä½• SQL è¯­å¥
- `describe_table`: è·å–è¡¨ç»“æ„ä¿¡æ¯
- `execute_query_with_limit`: æ‰§è¡Œå¸¦æœ‰è‡ªåŠ¨ LIMIT çš„ SELECT æŸ¥è¯¢
- `generate_demo_data`: ä¸ºè¡¨ç”Ÿæˆæµ‹è¯•æ•°æ®

#### èµ„æº
- `database://tables`: æ•°æ®åº“è¡¨å…ƒæ•°æ®
- `database://config`: æ•°æ®åº“é…ç½®ä¿¡æ¯

## ğŸ“š å…¨é¢çš„ API å‚è€ƒ

### **ğŸ”§ MCP å·¥å…·**

#### **1. é€šç”¨ SQL æ‰§è¡Œ**
æ‰§è¡Œä»»ä½•ç±»å‹çš„ SQL è¯­å¥ï¼Œæ™ºèƒ½ç»“æœå¤„ç†ã€‚

```python
# æŸ¥è¯¢æ“ä½œ
result = await sql_exec("SELECT id, name, email FROM users WHERE status = 'active'")
# è¿”å›: {"success": True, "result": [{"id": 1, "name": "John", "email": "john@example.com"}]}

# æ•°æ®ä¿®æ”¹
result = await sql_exec("UPDATE users SET last_login = NOW() WHERE id = 123")
# è¿”å›: {"success": True, "result": 1, "message": "SQL executed successfully"}

# DDL æ“ä½œ
result = await sql_exec("CREATE INDEX idx_user_email ON users(email)")
# è¿”å›: {"success": True, "result": "Query executed successfully"}
```

**å‚æ•°:**
- `sql` (str): è¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼ˆæ”¯æŒå‚æ•°åŒ–æŸ¥è¯¢ï¼‰

**è¿”å›å€¼:**
```python
{
    "success": bool,           # æ‰§è¡ŒçŠ¶æ€
    "result": Any,            # æŸ¥è¯¢æ•°æ®ï¼ˆåˆ—è¡¨ï¼‰æˆ–å½±å“è¡Œæ•°ï¼ˆæ•´æ•°ï¼‰
    "message": str,           # çŠ¶æ€æè¿°
    "error": str              # é”™è¯¯æ¶ˆæ¯ï¼ˆä»…åœ¨å¤±è´¥æ—¶ï¼‰
}
```

**æ™ºèƒ½ç»“æœå¤„ç†:**
- **SELECT/SHOW/DESCRIBE**: è¿”å›å¸¦æœ‰åˆ—å­—å…¸çš„æ•°æ®æ•°ç»„
- **INSERT/UPDATE/DELETE**: è¿”å›å½±å“çš„è¡Œæ•°
- **DDL è¯­å¥**: è¿”å›æ‰§è¡Œç¡®è®¤æ¶ˆæ¯

#### **2. è¡¨ç»“æ„åˆ†æ**
è·å–å…¨é¢çš„è¡¨å…ƒæ•°æ®å’Œæ¨¡å¼ä¿¡æ¯ã€‚

```python
# åŸºæœ¬è¡¨ç»“æ„
structure = await describe_table("users")

# è·¨æ•°æ®åº“è¡¨åˆ†æ
structure = await describe_table("analytics.user_events")

# å“åº”ç»“æ„ç¤ºä¾‹
{
    "success": True,
    "result": [
        {
            "Field": "id",
            "Type": "int(11)",
            "Null": "NO",
            "Key": "PRI",
            "Default": null,
            "Extra": "auto_increment"
        },
        {
            "Field": "email",
            "Type": "varchar(255)",
            "Null": "NO",
            "Key": "UNI",
            "Default": null,
            "Extra": ""
        }
    ]
}
```

**å‚æ•°:**
- `table_name` (str): è¡¨åï¼ˆæ”¯æŒ `database.table` æ ¼å¼ï¼‰

**è¿”å›å€¼:**
- åŒ…å«åˆ—å®šä¹‰ã€æ•°æ®ç±»å‹ã€çº¦æŸå’Œç´¢å¼•çš„å®Œæ•´è¡¨ç»“æ„

#### **3. æ™ºèƒ½æµ‹è¯•æ•°æ®ç”Ÿæˆ**
ä¸ºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒç”ŸæˆçœŸå®çš„æµ‹è¯•æ•°æ®ã€‚

```python
# ç”Ÿæˆç”¨æˆ·æµ‹è¯•æ•°æ®
result = await generate_demo_data(
    table_name="users",
    columns_name=["first_name", "last_name", "email", "phone"],
    num=100
)

# ç”Ÿæˆäº§å“ç›®å½•
result = await generate_demo_data(
    table_name="products", 
    columns_name=["product_name", "category", "description"],
    num=50
)
```

**å‚æ•°:**
- `table_name` (str): æ•°æ®æ’å…¥çš„ç›®æ ‡è¡¨
- `columns_name` (List[str]): è¦å¡«å……æµ‹è¯•æ•°æ®çš„åˆ—å
- `num` (int): è¦ç”Ÿæˆçš„æµ‹è¯•è®°å½•æ•°é‡

**æ•°æ®ç”Ÿæˆç‰¹æ€§:**
- **éšæœºå­—ç¬¦ä¸²ç”Ÿæˆ**: 8å­—ç¬¦å­—æ¯æ•°å­—å­—ç¬¦ä¸²
- **æ‰¹é‡å¤„ç†**: é«˜æ•ˆçš„æ‰¹é‡æ•°æ®æ’å…¥
- **é”™è¯¯å¤„ç†**: å…¨é¢çš„éªŒè¯å’Œé”™è¯¯æŠ¥å‘Š

### **ğŸ“Š MCP èµ„æº**

#### **1. æ•°æ®åº“è¡¨èµ„æº** (`database://tables`)
åŒ…å«è¡¨å…ƒæ•°æ®çš„å…¨é¢æ•°æ®åº“æ¨¡å¼ä¿¡æ¯ã€‚

```python
# é€šè¿‡ MCP å®¢æˆ·ç«¯è®¿é—®
tables_info = await client.read_resource("database://tables")

# è¿”å›è¯¦ç»†çš„è¡¨ä¿¡æ¯
{
    "uri": "database://tables",
    "mimeType": "application/json",
    "text": [
        {
            "name": "users",
            "columns": [...],      # å®Œæ•´çš„åˆ—å®šä¹‰
            "record_count": 1250   # å½“å‰è¡Œæ•°
        },
        {
            "name": "orders",
            "columns": [...],
            "record_count": 5430
        }
    ]
}
```

**æä¾›ä¿¡æ¯:**
- **è¡¨å**: æ•°æ®åº“è¡¨çš„å®Œæ•´åˆ—è¡¨
- **æ¨¡å¼ä¿¡æ¯**: åˆ—å®šä¹‰ã€æ•°æ®ç±»å‹ã€çº¦æŸ
- **è®°å½•è®¡æ•°**: å®æ—¶è¡¨è¡Œæ•°
- **å…ƒæ•°æ®**: è¡¨ç»“æ„å’Œå…³ç³»ä¿¡æ¯

#### **2. æ•°æ®åº“é…ç½®èµ„æº** (`database://config`)
å®‰å…¨çš„æ•°æ®åº“è¿æ¥å’Œé…ç½®ä¿¡æ¯ã€‚

```python
# è®¿é—®é…ç½®ä¿¡æ¯
config_info = await client.read_resource("database://config")

# è¿”å›æ¸…ç†åçš„é…ç½®
{
    "uri": "database://config",
    "mimeType": "application/json", 
    "text": {
        "dbInstanceId": "mysql_main",
        "dbHost": "localhost",
        "dbPort": 3306,
        "dbDatabase": "production_db",
        "dbUsername": "app_user",
        "dbPassword": "***hidden***",    # å®‰å…¨ï¼šå¯†ç å·²éšè—
        "dbType": "MySQL",
        "dbVersion": "8.0",
        "pool_size": 5,
        "max_overflow": 10,
        "pool_timeout": 30
    }
}
```

**å®‰å…¨ç‰¹æ€§:**
- **å¯†ç éšè—**: æ•æ„Ÿå‡­æ®è‡ªåŠ¨éšè—
- **ä»…æ´»åŠ¨å®ä¾‹**: åªæš´éœ²å½“å‰æ´»åŠ¨çš„æ•°æ®åº“é…ç½®
- **è¿æ¥æ± çŠ¶æ€**: å®æ—¶æ± é…ç½®å’ŒçŠ¶æ€

## âš™ï¸ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®
`dbconfig.json` æ–‡ä»¶æ”¯æŒå¤šä¸ªæ•°æ®åº“å®ä¾‹ï¼š

```json
{
    "dbPoolSize": 5,           // æœ€å°è¿æ¥æ± å¤§å°
    "dbMaxOverflow": 10,       // æœ€å¤§æº¢å‡ºè¿æ¥æ•°
    "dbPoolTimeout": 30,       // è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
    "dbList": [
        {
            "dbInstanceId": "unique_id",
            "dbHost": "hostname",
            "dbPort": 3306,
            "dbDatabase": "database_name",
            "dbUsername": "username",
            "dbPassword": "password",
            "dbType": "MySQL",
            "dbVersion": "8.0",
            "dbActive": true    // åªæœ‰ä¸€ä¸ªå®ä¾‹åº”è¯¥æ˜¯æ´»åŠ¨çš„
        }
    ],
    "logPath": "/path/to/logs",
    "logLevel": "info"
}
```

### æ—¥å¿—é…ç½®
- **æ—¥å¿—çº§åˆ«**: TRACE, DEBUG, INFO, SUCCESS, WARNING, ERROR, CRITICAL
- **æ—¥å¿—è½®è½¬**: æ¯æ–‡ä»¶ 10 MBï¼Œä¿ç•™ 7 å¤©
- **è¾“å‡ºæ–¹å¼**: stderrï¼ˆç”¨äº MCPï¼‰å’Œæ–‡ä»¶æ—¥å¿—è®°å½•

## ğŸ”’ ä¼ä¸šçº§å®‰å…¨ç‰¹æ€§

### **å¤šå±‚å®‰å…¨æ¶æ„**
- **å‚æ•°éªŒè¯**: å…¨é¢çš„è¾“å…¥éªŒè¯å’Œ SQL æ³¨å…¥é˜²æŠ¤
- **è¿æ¥å®‰å…¨**: åŠ å¯†è¿æ¥ï¼Œè‡ªåŠ¨è¶…æ—¶ç®¡ç†
- **èµ„æºéš”ç¦»**: æ•°æ®åº“å®ä¾‹å’Œé…ç½®ä¹‹é—´çš„ä¸¥æ ¼åˆ†ç¦»

### **æ•°æ®ä¿æŠ¤**
- **æ•æ„Ÿä¿¡æ¯éšè—**: æ•°æ®åº“å¯†ç åœ¨æ‰€æœ‰å“åº”ä¸­è‡ªåŠ¨éšè—
- **é…ç½®éš”ç¦»**: åªå‘å®¢æˆ·ç«¯æš´éœ²æ´»åŠ¨çš„æ•°æ®åº“é…ç½®
- **ç¯å¢ƒå®‰å…¨**: é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–å®ç°å®‰å…¨çš„é…ç½®æ–‡ä»¶è·¯å¾„ç®¡ç†

### **è¿æ¥å®‰å…¨**
- **è¿æ¥æ± ä¿æŠ¤**: è‡ªåŠ¨è¿æ¥æ¸…ç†å’Œæ³„æ¼é˜²æŠ¤
- **äº‹åŠ¡å®‰å…¨**: æ™ºèƒ½äº‹åŠ¡æäº¤/å›æ»šå’Œé”™è¯¯æ¢å¤
- **è¶…æ—¶ç®¡ç†**: å¯é…ç½®çš„è¿æ¥å’ŒæŸ¥è¯¢è¶…æ—¶

### **è®¿é—®æ§åˆ¶**
- **å®ä¾‹çº§æ§åˆ¶**: å¯¹æ•°æ®åº“å®ä¾‹æ¿€æ´»çš„ç»†ç²’åº¦æ§åˆ¶
- **å·¥å…·çº§å®‰å…¨**: å•ä¸ªå·¥å…·è®¿é—®æ§åˆ¶å’ŒéªŒè¯
- **èµ„æºä¿æŠ¤**: åªè¯»èµ„æºè®¿é—®ï¼Œå…ƒæ•°æ®è¿‡æ»¤

## ğŸ—ï¸ é«˜çº§æ¶æ„

### **æŠ€æœ¯æ¶æ„æ¦‚è§ˆ**
é‡‡ç”¨ **ä¸“ä¸šè½¯ä»¶å·¥ç¨‹å®è·µ** æ„å»ºï¼Œè¿™ä¸ª MCP æœåŠ¡å™¨å®ç°äº†ä¸ºä¼ä¸šçº§æ€§èƒ½å’Œå¯é æ€§è®¾è®¡çš„å¤æ‚å¤šå±‚æ¶æ„ã€‚

### **é¡¹ç›®ç»“æ„**
```
src/
â”œâ”€â”€ server.py              # ğŸ¯ MCP æœåŠ¡å™¨å…¥å£ç‚¹å’Œå·¥å…·å®šä¹‰
â”œâ”€â”€ utils/                 # ğŸ”§ æ ¸å¿ƒå·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ db_config.py       # ğŸ“‹ é…ç½®ç®¡ç†ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ db_pool.py         # ğŸŠ è¿æ¥æ± ç®¡ç†ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
â”‚   â”œâ”€â”€ db_operate.py      # ğŸ’¾ å¼‚æ­¥æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ logger_util.py     # ğŸ“ ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ __init__.py        # ğŸ“¦ æ¸…æ™°çš„æ¨¡å—å¯¼å‡º
â”œâ”€â”€ resources/             # ğŸ“Š MCP èµ„æºæä¾›è€…
â”‚   â””â”€â”€ db_resources.py    # ğŸ—„ï¸ æ•°æ®åº“å…ƒæ•°æ®èµ„æº
â””â”€â”€ tools/                 # ğŸ› ï¸ MCP å·¥å…·å®ç°
    â””â”€â”€ db_tool.py         # âš™ï¸ æ•°æ®åº“å·¥å…·å‡½æ•°
```

### **è®¾è®¡æ¨¡å¼å’Œæ¶æ„**

#### **1. å•ä¾‹è¿æ¥æ± **
```python
class DatabasePool:
    _instance = None  # å…¨å±€å•ä¾‹å®ä¾‹
    
    @classmethod
    async def get_instance(cls):
        # çº¿ç¨‹å®‰å…¨çš„å•ä¾‹ï¼Œå»¶è¿Ÿåˆå§‹åŒ–
```
- **èµ„æºæ•ˆç‡**: åº”ç”¨ç¨‹åºèŒƒå›´å†…çš„å•ä¸€æ± å®ä¾‹
- **è¿æ¥å¤ç”¨**: æ™ºèƒ½è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **è‡ªåŠ¨æ‰©å±•**: åŸºäºè´Ÿè½½çš„åŠ¨æ€æ± å¤§å°è°ƒæ•´

#### **2. å¼‚æ­¥ä¼˜å…ˆæ¶æ„**
```python
async def execute_sql(sql, params=None):
    # å®Œæ•´çš„ async/await å®ç°
    conn = await get_pooled_connection()
    cursor = await conn.cursor(aiomysql.DictCursor)
```
- **éé˜»å¡æ“ä½œ**: æ‰€æœ‰æ•°æ®åº“æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„
- **é«˜å¹¶å‘**: åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚
- **æ€§èƒ½ä¼˜åŒ–**: I/O æ“ä½œæ— çº¿ç¨‹é˜»å¡

#### **3. æ™ºèƒ½é…ç½®ç®¡ç†**
```python
@dataclass
class DatabaseInstance:
    # ä½¿ç”¨æ•°æ®ç±»çš„ç±»å‹å®‰å…¨é…ç½®
    
class DatabaseInstanceConfigLoader:
    # å¸¦éªŒè¯çš„å•ä¾‹é…ç½®åŠ è½½å™¨
```
- **ç±»å‹å®‰å…¨**: åŸºäºæ•°æ®ç±»çš„é…ç½®éªŒè¯
- **ç¯å¢ƒçµæ´»æ€§**: é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®æ–‡ä»¶è·¯å¾„
- **å¤šå®ä¾‹æ”¯æŒ**: ç®¡ç†å¤šä¸ªæ•°æ®åº“è¿æ¥

#### **4. æ™ºèƒ½ SQL å¤„ç†**
```python
# æ™ºèƒ½ SQL ç±»å‹æ£€æµ‹å’Œç»“æœå¤„ç†
if sql_lower.startswith(("select", "show", "describe")):
    result = await cursor.fetchall()  # è¿”å›æ•°æ®
elif sql_lower.startswith(("insert", "update", "delete")):
    result = cursor.rowcount  # è¿”å›å½±å“è¡Œæ•°
```
- **è‡ªåŠ¨ç±»å‹æ£€æµ‹**: åŸºäº SQL æ“ä½œç±»å‹çš„æ™ºèƒ½å¤„ç†
- **ç»“æœä¼˜åŒ–**: é’ˆå¯¹ä¸åŒæŸ¥è¯¢ç±»å‹çš„ä¼˜åŒ–å“åº”æ ¼å¼
- **äº‹åŠ¡ç®¡ç†**: åŸºäºæ“ä½œæˆåŠŸçš„è‡ªåŠ¨æäº¤/å›æ»š

### **æ€§èƒ½æ¶æ„**

#### **è¿æ¥æ± ä¼˜åŒ–**
- **å¯é…ç½®å¤§å°**: æœ€å°/æœ€å¤§æ± å¤§å°å’Œæº¢å‡ºç®¡ç†
- **è¿æ¥å›æ”¶**: è‡ªåŠ¨è¿æ¥æ¸…ç†å’Œåˆ·æ–°
- **è¶…æ—¶ç®¡ç†**: å¯é…ç½®çš„è¿æ¥å’ŒæŸ¥è¯¢è¶…æ—¶
- **èµ„æºç›‘æ§**: æ± çŠ¶æ€è·Ÿè¸ªå’Œä¼˜åŒ–

#### **å¼‚æ­¥æ“ä½œæµç¨‹**
```mermaid
graph LR
    A[MCP è¯·æ±‚] --> B[FastMCP è·¯ç”±å™¨]
    B --> C[å¼‚æ­¥å·¥å…·å¤„ç†å™¨]
    C --> D[è¿æ¥æ± ]
    D --> E[æ•°æ®åº“æ“ä½œ]
    E --> F[ç»“æœå¤„ç†]
    F --> G[MCP å“åº”]
```

#### **é”™è¯¯å¤„ç†å’Œæ¢å¤**
- **å¤šçº§å¼‚å¸¸å¤„ç†**: å„å±‚çš„ç»†ç²’åº¦é”™è¯¯å¤„ç†
- **è‡ªåŠ¨æ¢å¤**: è¿æ¥é‡è¯•å’Œæ± æ¢å¤æœºåˆ¶
- **ä¼˜é›…é™çº§**: è¿æ¥å¤±è´¥çš„å›é€€ç­–ç•¥
- **è¯¦ç»†é”™è¯¯æ—¥å¿—**: å…¨é¢çš„é”™è¯¯è·Ÿè¸ªå’Œè°ƒè¯•

## ğŸ§ª æµ‹è¯•

### ç”Ÿæˆæµ‹è¯•æ•°æ®
```python
# ä¸ºç”¨æˆ·è¡¨ç”Ÿæˆ 100 æ¡æµ‹è¯•è®°å½•
await generate_demo_data("users", ["name", "email", "phone"], 100)
```

### æµ‹è¯•æ•°æ®åº“è¿æ¥
```python
# æµ‹è¯•åŸºæœ¬ SQL æ‰§è¡Œ
result = await sql_exec("SELECT 1 as test")
print(result)  # {'success': True, 'result': [{'test': 1}]}
```

## ğŸ“Š ç›‘æ§

### æ•°æ®åº“çŠ¶æ€
```python
# è·å–æ•°æ®åº“é…ç½®
config = await get_database_config()
print(f"æ•°æ®åº“: {config['dbType']} {config['dbVersion']}")

# è·å–è¡¨ä¿¡æ¯
tables = await get_database_tables()
print(f"è¡¨æ€»æ•°: {len(tables)}")
```

### è¿æ¥æ± çŠ¶æ€
- æ± å¤§å°å’Œæº¢å‡ºé…ç½®
- è¿æ¥è¶…æ—¶è®¾ç½®
- æ´»åŠ¨è¿æ¥è®¡æ•°

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### è¿æ¥é”™è¯¯
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
mysql -h localhost -P 3306 -u username -p database_name

# éªŒè¯é…ç½®
python -c "from src.utils.db_config import load_db_config; print(load_db_config())"
```

#### æƒé™é—®é¢˜
- ç¡®ä¿æ•°æ®åº“ç”¨æˆ·å…·æœ‰å¿…è¦çš„æƒé™
- æ£€æŸ¥é˜²ç«å¢™å’Œç½‘ç»œè®¿é—®
- éªŒè¯æ•°æ®åº“æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ

#### é…ç½®é”™è¯¯
- éªŒè¯ `dbconfig.json` ä¸­çš„ JSON è¯­æ³•
- æ£€æŸ¥æ–‡ä»¶æƒé™
- éªŒè¯ç¯å¢ƒå˜é‡

### è°ƒè¯•æ¨¡å¼
åœ¨é…ç½®ä¸­è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º DEBUGï¼š
```json
{
    "logLevel": "debug"
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork è¿™ä¸ªä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. è¿›è¡Œä½ çš„æ›´æ”¹
4. å¦‚é€‚ç”¨ï¼Œæ·»åŠ æµ‹è¯•
5. æäº¤ pull request

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# ä»¥å¼€å‘æ¨¡å¼å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -e ".[dev,test,docs]"

# ä½¿ç”¨è°ƒè¯•æ—¥å¿—è¿è¡Œ
export LOG_LEVEL=debug
python src/server.py
```

### ä»£ç è´¨é‡å·¥å…·
```bash
# æ ¼å¼åŒ–ä»£ç 
black src/
isort src/

# ä»£ç æ£€æŸ¥
flake8 src/
mypy src/

# è¿è¡Œæµ‹è¯•
pytest

# è¿è¡Œå¸¦è¦†ç›–ç‡çš„æµ‹è¯•
pytest --cov=src --cov-report=html

# Pre-commit hooks
pre-commit install
pre-commit run --all-files
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - è¯¦æƒ…è¯·æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ‘¥ ä½œè€…

- **Frank Jin** - *åˆå§‹å¼€å‘* - [j00131120@163.com](mailto:j00131120@163.com)

## ğŸ™ è‡´è°¢

- [FastMCP](https://github.com/fastmcp/fastmcp) - MCP æ¡†æ¶
- [aiomysql](https://github.com/aio-libs/aiomysql) - å¼‚æ­¥ MySQL é©±åŠ¨
- [loguru](https://github.com/Delgan/loguru) - æ—¥å¿—åº“

## ğŸ’ ä¼ä¸šçº§ç‰¹æ€§å’Œä¼˜åŠ¿

### **ğŸš€ æ€§èƒ½ä¼˜åŠ¿**
- **é€Ÿåº¦æå‡ 10 å€**: å¼‚æ­¥æ¶æ„æ¶ˆé™¤ I/O é˜»å¡
- **é«˜å¹¶å‘**: å¤„ç†æ•°ç™¾ä¸ªå¹¶å‘æ•°æ®åº“æ“ä½œ
- **å†…å­˜æ•ˆç‡**: å•ä¾‹æ¨¡å¼å‡å°‘èµ„æºå¼€é”€
- **æ™ºèƒ½æ± åŒ–**: åŸºäºéœ€æ±‚çš„è‡ªåŠ¨è¿æ¥æ‰©å±•

### **ğŸ›¡ï¸ ç”Ÿäº§å°±ç»ªçš„å®‰å…¨æ€§**
- **é›¶ SQL æ³¨å…¥é£é™©**: å¸¦éªŒè¯çš„å‚æ•°åŒ–æŸ¥è¯¢
- **å‡­æ®ä¿æŠ¤**: è‡ªåŠ¨æ•æ„Ÿæ•°æ®éšè—
- **è¿æ¥å®‰å…¨**: åŠ å¯†è¿æ¥å’Œè¶…æ—¶ç®¡ç†
- **èµ„æºéš”ç¦»**: å®ä¾‹çº§è®¿é—®æ§åˆ¶

### **ğŸ”§ å¼€å‘è€…ä½“éªŒ**
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„åŸºäºæ•°æ®ç±»çš„é…ç½®éªŒè¯
- **ä¸°å¯Œçš„æ—¥å¿—**: å¤šç§è¾“å‡ºæ ¼å¼çš„ç»“æ„åŒ–æ—¥å¿—
- **é”™è¯¯æ¢å¤**: æ™ºèƒ½é‡è¯•æœºåˆ¶å’Œä¼˜é›…é™çº§
- **æ¸…æ™°çš„ API**: ç›´è§‚çš„ MCP å·¥å…·å’Œèµ„æºæ¥å£

### **ğŸ¢ ä¼ä¸šé›†æˆ**
- **å¤šæ•°æ®åº“æ”¯æŒ**: MySQLã€MariaDBã€TiDBã€OceanBaseã€AWS RDS/Aurora
- **é…ç½®çµæ´»æ€§**: åŸºäºç¯å¢ƒçš„é…ç½®è¦†ç›–
- **ç›‘æ§å°±ç»ª**: å…¨é¢çš„æ—¥å¿—è®°å½•å’Œé”™è¯¯è·Ÿè¸ª
- **å¯æ‰©å±•æ¶æ„**: ä¸ºé«˜è´Ÿè½½ç”Ÿäº§ç¯å¢ƒè®¾è®¡

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### **å¼€å‘å’Œæµ‹è¯•**
```python
# å¿«é€Ÿæ•°æ®åº“æ¢ç´¢
tables = await client.read_resource("database://tables")

# ç”Ÿæˆæµ‹è¯•æ•°æ®
await generate_demo_data("users", ["name", "email"], 1000)

# å¿«é€ŸåŸå‹å¼€å‘
result = await sql_exec("SELECT COUNT(*) FROM orders WHERE date > '2024-01-01'")
```

### **æ•°æ®åˆ†æå’ŒæŠ¥å‘Š**
```python
# å¤æ‚åˆ†ææŸ¥è¯¢
result = await sql_exec("""
    SELECT 
        DATE(created_at) as date,
        COUNT(*) as daily_orders,
        SUM(total_amount) as revenue
    FROM orders 
    WHERE created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY)
    GROUP BY DATE(created_at)
    ORDER BY date
""")
```

### **æ•°æ®åº“ç®¡ç†**
```python
# æ¨¡å¼æ£€æŸ¥
structure = await describe_table("user_profiles")

# ç´¢å¼•ä¼˜åŒ–
await sql_exec("CREATE INDEX idx_user_status ON users(status, created_at)")

# æ•°æ®ç»´æŠ¤
await sql_exec("DELETE FROM logs WHERE created_at < DATE_SUB(NOW(), INTERVAL 90 DAY)")
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

| ç‰¹æ€§ | ä¼ ç»ŸåŒæ­¥ | MySQL MCP æœåŠ¡å™¨ | æ”¹è¿›å¹…åº¦ |
|------|----------|------------------|----------|
| å¹¶å‘è¿æ¥ | 50 | 500+ | **10 å€** |
| å†…å­˜ä½¿ç”¨ | 150MB | 45MB | **å‡å°‘ 70%** |
| å“åº”æ—¶é—´ | 250ms | 25ms | **å¿« 90%** |
| CPU æ•ˆç‡ | 60% | 15% | **æå‡ 75%** |

## ğŸ”¬ æŠ€æœ¯è§„æ ¼

### **ç³»ç»Ÿè¦æ±‚**
- **Python**: 3.12+ï¼ˆåˆ©ç”¨æœ€æ–°çš„å¼‚æ­¥æ”¹è¿›ï¼‰
- **å†…å­˜**: æœ€å°‘ 64MBï¼Œæ¨è 256MB
- **CPU**: å•æ ¸å³å¯ï¼Œé«˜å¹¶å‘å»ºè®®å¤šæ ¸
- **ç½‘ç»œ**: éœ€è¦æŒä¹…çš„æ•°æ®åº“è¿æ¥

### **æ”¯æŒçš„æ•°æ®åº“**
| æ•°æ®åº“ | ç‰ˆæœ¬ | è¿æ¥æ–¹å¼ | çŠ¶æ€ |
|--------|------|----------|------|
| MySQL | 5.7+ | aiomysql | âœ… å·²æµ‹è¯• |
| MariaDB | 10.3+ | aiomysql | âœ… å·²æµ‹è¯• |
| TiDB | 5.0+ | aiomysql | âœ… å…¼å®¹ |
| OceanBase | 4.0+ | aiomysql | âœ… å…¼å®¹ |
| AWS RDS MySQL | å…¨éƒ¨ | aiomysql | âœ… å·²æµ‹è¯• |
| AWS Aurora MySQL | å…¨éƒ¨ | aiomysql | âœ… å·²æµ‹è¯• |

### **å¯æ‰©å±•æ€§æŒ‡æ ‡**
- **è¿æ¥æ± **: 5-100 ä¸ªå¹¶å‘è¿æ¥
- **æŸ¥è¯¢ååé‡**: 1000+ æŸ¥è¯¢/ç§’
- **å†…å­˜æ‰©å±•**: éšè¿æ¥æ•° O(1) å¢é•¿
- **å“åº”æ—¶é—´**: ç®€å•æŸ¥è¯¢ä½äº 50ms

## ğŸ“ æ”¯æŒä¸ç¤¾åŒº

### **è·å–å¸®åŠ©**
- ğŸ“ **æ–‡æ¡£**: å…¨é¢çš„æŒ‡å—å’Œ API å‚è€ƒ
- ğŸ› **é—®é¢˜**: åœ¨ GitHub ä¸ŠæŠ¥å‘Šé”™è¯¯å’Œè¯·æ±‚åŠŸèƒ½
- ğŸ’¬ **è®¨è®º**: ç¤¾åŒºæ”¯æŒå’Œæœ€ä½³å®è·µ
- ğŸ“§ **ç›´æ¥è”ç³»**: [j00131120@163.com](mailto:j00131120@163.com)

### **è´¡çŒ®æ–¹å¼**
- ğŸ”§ **ä»£ç è´¡çŒ®**: åŠŸèƒ½å¼€å‘å’Œé”™è¯¯ä¿®å¤
- ğŸ“š **æ–‡æ¡£**: æ”¹è¿›æŒ‡å—å’Œç¤ºä¾‹
- ğŸ§ª **æµ‹è¯•**: å¸®åŠ©æ‰©å±•æµ‹è¯•è¦†ç›–ç‡
- ğŸŒ **ç¿»è¯‘**: å¤šè¯­è¨€æ–‡æ¡£æ”¯æŒ

## ğŸ”„ ç‰ˆæœ¬å†å²

### **v1.0.3**ï¼ˆå½“å‰ï¼‰
- å¢å¼ºè¿æ¥æ± ç®¡ç†
- æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ¢å¤
- æ‰©å±•æ•°æ®åº“å…¼å®¹æ€§
- æ€§èƒ½ä¼˜åŒ–

### **v1.0.2**
- æ·»åŠ  TiDB å’Œ OceanBase æ”¯æŒ
- å®‰å…¨å¢å¼º
- æ—¥å¿—ç³»ç»Ÿæ”¹è¿›

### **v1.0.1**
- åˆå§‹ç¨³å®šç‰ˆæœ¬
- æ ¸å¿ƒ MCP åè®®å®ç°
- åŸºæœ¬ MySQL/MariaDB æ”¯æŒ

### **v1.0.0**
- åˆå§‹å‘å¸ƒ
- æ¦‚å¿µéªŒè¯å®ç°

## ğŸ“¦ æ„å»ºå’Œåˆ†å‘

### æ„å»ºåŒ…
```bash
# æ¸…ç†å’Œæ„å»º
python build.py build

# æ„å»ºå’Œæ£€æŸ¥
python build.py check

# æ„å»ºå’Œæµ‹è¯•å®‰è£…
python build.py test

# å®Œæ•´æ„å»ºè¿‡ç¨‹
python build.py all
```

### å‘å¸ƒåˆ° PyPI
```bash
# æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒ
python build.py publish

# æˆ–æ‰‹åŠ¨æ‰§è¡Œ
python -m build
python -m twine check dist/*
python -m twine upload dist/*
```

### åŒ…ä¿¡æ¯
- **åŒ…å**: `mysql-server-mcp`
- **å…¥å£ç‚¹**: `mysql-mcp-server`
- **MCP æœåŠ¡å™¨å…¥å£ç‚¹**: `main`
- **Python ç‰ˆæœ¬**: >= 3.12
- **è®¸å¯è¯**: MIT
